* 13 布局和工作空间

布局是与缓冲区列表相关联的窗口配置．缓冲区列表可以是任意选择的一组缓冲区．Spacemacs提供了一些设施来创建有意义的缓冲区列表，比如缓冲区和项目相关的缓冲区．

当前布局的名字出现在mode-line的最左边(mode-line的第一个元素)．

要创建一个新的布局类型，他的编号是不存在的．例如如果当前有两个布局，那么创建第三个的布局就是 SPC l 3

** 13.1.1 默认的布局

这个默认(default)的布局(这个布局再emacs启动的时候就被创建了)是不会显示在mode-line的，但是是可以设置dotspacemacs-display-default-layout -> t 来设置成为显示的．

他将称默认为"default"，但是这个"default"名字也可以通过设置变量来改变．变量的名字就是"dotspacemacs-default-layout-name"．

这个默认的布局是特殊的，因为他具有全局的范围，这意味着所有打开的缓冲区都属于它．因此使用默认的布局就跟感觉没使用一样．

** 13.1.2 项目的布局
一个项目的布局必然会绑定在一个projectile项目．创建一个项目使用快捷键SPC p l，layout的的名字就是这个项目根目录的名字．

** 13.1.3 自定义布局
自定义布局可以被使用spacemacs|define-custom-layout这个宏来定义，你可以通过按快捷键SPC l o．

通俗的约定一般一个自定义的布局应该以"@"开始．

举个例子：定义一个自定义layout，名字就叫ERC缓冲

#+srcname:ERC_BUFFER
#+begin_src emacs-lisp
(Spacemacs|define-custom-layout "@ERC"
  :binding "E"
  :body
  (progn
    ;; hook to add all ERC buffers to the layout
    (defun spacemacs-layouts/add-erc-buffer-to-persp ()
      (persp-add-buffer (current-buffer)
                        (persp-get-by-name
                         erc-spacemacs-layout-name)))
    (add-hook 'erc-mode-hook #'spacemacs-layouts/add-erc-buffer-to-persp)
    ;; Start ERC
    (call-interactively 'erc)))
#+end_src

使用快捷键SPC l o E 来在自己的布局内启用ERC，任何一个新的ERC缓冲区将会是这个自定义布局的一部分．

一些自定义的布局是附送在spacemacss上的：

| Name       | Key Binding | Description                                        |
|------------+-------------+----------------------------------------------------|
| @Spacemacs | e           | 包含~/emaces.d的所有缓冲区的自定义视图             |
| @ERT       | E           | 包含所有ERC缓冲区的自定义视图(需要ERC布局开启)     |
| @RCIRC     | i           | 包含所有RCIRC缓冲区的自定义视图(需要RCIRC布局开启) |
| @Org       | o           | 包含所有org-agenda缓冲区的自定义视图               |


** 13.1.4保存或加载布局成文件

SPC l s 可以保存布局到一个文件
SPC l L 可以从文件加载布局

注意：通常的，spacemacs将自动的保存布局，名称为persp-auto-save.

设置这个变量 dotspacemacs-auto-resume-layout t　将自动的还原最后保存的布局

** 13.1.5 布局快捷键的绑定
布局快捷见的绑定和注册在一个瞬间状态．瞬态状态的文档字符串显示现有的布局，当前活动的布局有方括号，按一个布局的编号将会激活他（或者创建一个新的）并且退出这个瞬间状态．
同样可以使用快捷键Ctrl-<number>仅仅预览一个布局．按TAB将会激活之前选中的布局．

按"?"来切换文档状态．
| Key Binding    | Description                                    |
|----------------+------------------------------------------------|
| SPC l          | 激活瞬间状态(transient-state)                  |
| ?              | 切换问这个文档状态                             |
| 1..9, 0        | 切换到第n个布局                                |
| [C-1..C-9,C-0] | 切换到第n个布局并且保持在瞬间状态激活          |
| <tab>          | 切换到上一个布局                               |
| a              | 在当前的布局上增加一个缓冲区                   |
| Ａ             | 在当前布局的缓冲区里增加所有另一个布局的缓冲区 |
| b              | 选择一个缓冲区到当前的布局                     |
| d              | 删除当前的布局并保留其缓冲区                   |
| D              | 删除其他的布局并且保留其他的缓冲区             |
| h              | 去默认布局                                     |
| C-h            | 上一个列表的布局                               |
| l              | 用helm选择或创建一个布局                       |
| L              | 加载一个文件里的布局                           |
| C-l            | 列表里下一个布局                               |
| n              | 列表里下一个布局                               |
| N              | 列表里上一个布局                               |
| o              | 打开一个自定义布局                             |
| p              | 列表里上一个布局                               |
| r              | 删除当前的布局里的缓冲区                       |
| R              | 删除当前的布局                                 |
| s              | 保存布局                                       |
| ｔ             | 显示缓冲区而不将其添加到当前布局               |
| w              | 工作区瞬间状态（需要启用eyebrowse）布局        |
| x              | 用其缓冲区杀死当前布局                         |
| X              | 用其缓冲区杀死其他布局                         |

** 工作空间

工作空间是子布局，他允许定义多个布局到一个给定的布局，他们的布局与这个布局共享相同的缓冲区．

当前激活的工作空间的编号显示在窗口编号的前面，比如 "①|④"或"1|4"意味着第一个工作区的第四个窗口。

切换到当前不居中不存在的工作空间将会创建一个新的工作区。比如启动后你可以按SPC l w 2 来创建2个在default布局里的工作空间。

当创建的工作空间是没有名字的，你可以使用快捷键SPC l w R给他们命名。

** 13.2.1 工作空间的快捷键绑定

快捷键的注册和绑定是在一个临时状态。临时状态的文档字符串显示在现有存在的工作区并且当前激活的工作空间有方括号。按下一个工作空间的编号将会激活他（或者创建一个新的）并且退出这个临时状态。
也可以仅仅按Ctrl-<Number>预览一下。
按TAB将会激活上一个选中的工作空间。

按 ? 来切换帮助的状态

| 快捷键绑定     | 描述                                      |
|----------------+-------------------------------------------|
| SPC l w        | 激活这个临时状态                          |
| ?              | 切换这个文档的状态                        |
| [1..9,0]       | 切换到第n个工作空间                       |
| [C-1..C-9,C-0] | 切换第n个工作空间并且保持临时状态是激活的 |
| TAB            | 选择上一个激活的工作空间                  |
| d              | 关闭当前的工作空间                        |
| n或l           | 切换下一个工作空间                        |
| N 或 p 或 h    | 切换上一个工作空间                        |
| R              | 给当前工作空间设置一个标签                |
| w              | 根据标签选择工作空间                      |

这里还有一些和工作空间相关的全局的可用快捷键：

| 快捷键绑定 | 描述                         |
| gt         | 去下一个工作空间             |
| gT         | 去上一个工作空间             |
| SPC b w    | 通过缓冲区进入工作空间和窗口 |
